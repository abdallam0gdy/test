<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù†Ø¸Ø§Ù… Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† V5 (Full Lockdown)</title>
    <style>
        /* --- 1. Ø­Ø¸Ø± Ø§Ù„ØªÙØ§Ø¹Ù„Ø§Øª (CSS Blocking) --- */
        body {
            margin: 0;
            font-family: 'Segoe UI', sans-serif;
            background: #f4f4f4;
            height: 100vh;
            overflow: hidden;
            
            /* Ù…Ù†Ø¹ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù†Øµ */
            user-select: none;
            -webkit-user-select: none; /* Ù„Ù…ØªØµÙØ­ ÙƒØ±ÙˆÙ… ÙˆØ³ÙØ§Ø±ÙŠ */
            -moz-user-select: none;
            -ms-user-select: none;
            
            /* Ù…Ù†Ø¹ Ø§Ù„Ù„Ù…Ø³ Ø§Ù„Ù…Ø·ÙˆÙ„ (Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© ÙÙŠ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„) */
            -webkit-touch-callout: none;
        }

        /* Ø§Ø³ØªØ«Ù†Ø§Ø¡: Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ÙƒØªØ§Ø¨Ø© Ø¯Ø§Ø®Ù„ Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© */
        textarea, input {
            user-select: text;
            -webkit-user-select: text;
        }

        /* --- Ø¨Ø§Ù‚ÙŠ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª (Ø²ÙŠ V4) --- */
        .container { display: flex; justify-content: center; align-items: center; height: 100%; flex-direction: column; text-align: center; }
        #start-screen { background: white; padding: 30px; border-radius: 15px; width: 90%; max-width: 500px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); }
        #exam-screen { display: none; width: 100%; height: 100%; background: white; padding: 20px; box-sizing: border-box; position: relative; overflow-y: auto; }
        #warning-overlay { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: #d32f2f; color: white; flex-direction: column; justify-content: center; align-items: center; z-index: 10000; text-align: center; }
        
        /* Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø§Ø¦ÙŠØ© */
        .watermark-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 9998; opacity: 0.07;
            display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            grid-template-rows: repeat(auto-fill, minmax(150px, 1fr)); overflow: hidden;
        }
        .watermark-item {
            display: flex; justify-content: center; align-items: center;
            transform: rotate(-30deg); font-weight: bold; font-size: 14px; color: #000; white-space: nowrap;
        }

        /* Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ */
        #toast-notification {
            position: fixed; top: -50px; left: 50%; transform: translateX(-50%);
            background: #d32f2f; color: white; padding: 10px 20px; border-radius: 0 0 10px 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2); z-index: 10001; transition: top 0.3s ease-in-out; font-weight: bold;
        }
        #toast-notification.show { top: 0; }
        
        button { padding: 12px 25px; margin: 10px; cursor: pointer; border: none; border-radius: 5px; color: white; transition: 0.3s; }
        .btn-blue { background: #007bff; } .btn-green { background: #28a745; display: none; } .btn-red { background: transparent; border: 2px solid white; }
    </style>
</head>
<body>

    <div id="toast-notification">âš ï¸ ØªÙ… Ø±ØµØ¯ Ù…Ø®Ø§Ù„ÙØ© Ø£Ù…Ù†ÙŠØ©!</div>

    <div id="start-screen" class="container">
        <h1>ğŸ”’ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† Ø§Ù„Ù…Ø¤Ù…Ù† V5</h1>
        <p style="color:red; font-size: 0.9em;">ØªÙ… ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ù†Ø³Ø®ØŒ Ø§Ù„Ù„ØµÙ‚ØŒ ÙˆØ§Ù„Ù„Ù…Ø³ Ø§Ù„Ù…Ø·ÙˆÙ„.</p>
        <button onclick="requestNotifyPermission()" id="notifyBtn" class="btn-blue">ğŸ”” ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</button>
        <p id="notifyStatus" style="font-size: 12px; color: gray;"></p>
        <button onclick="attemptStart()" id="startBtn" class="btn-green">ğŸš€ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†</button>
    </div>

    <div id="exam-screen">
        <div class="watermark-container"></div>
        <div style="background: #333; color: #0f0; padding: 10px; border-radius: 5px; position: relative; z-index: 9999;">
            â— Ø§Ù„Ù†Ø¸Ø§Ù… Ø¢Ù…Ù† - Ø§Ù„Ø·Ø§Ù„Ø¨: Ø£Ø­Ù…Ø¯ (Ù…Ù…Ù†ÙˆØ¹ Ø§Ù„Ù†Ø³Ø®)
        </div>
        <div style="position: relative; z-index: 9999; margin-top: 20px;">
            <h3>Ø¬Ø±Ø¨ ØªÙ†Ø³Ø® Ø§Ù„ÙƒÙ„Ø§Ù… Ø¯Ù‡:</h3>
            <p id="question-text">Ø¨Ù…Ø§ ØªÙØ³Ø±: Ù„Ø§ ÙŠÙ…ÙƒÙ† Ù†Ø³Ø® Ù‡Ø°Ø§ Ø§Ù„Ù†Øµ ÙˆÙ„Ø§ ÙŠÙ…ÙƒÙ† Ø¹Ù…Ù„ ÙƒÙ„ÙŠÙƒ ÙŠÙ…ÙŠÙ† Ø¹Ù„ÙŠÙ‡ØŸ</p>
            
            <h3>Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©:</h3>
            <textarea id="answer-box" 
                      style="width: 100%; height: 150px; border: 2px solid #ddd; padding: 10px; font-size: 18px;" 
                      placeholder="Ø­Ø§ÙˆÙ„ ØªØ¹Ù…Ù„ Paste Ù‡Ù†Ø§ (Ù„Ù† ÙŠØ¹Ù…Ù„)..."></textarea>
        </div>
    </div>

    <div id="warning-overlay">
        <h1>â›” Ù…Ø®Ø§Ù„ÙØ©!</h1>
        <h2 id="violation-reason" style="background: rgba(0,0,0,0.2); padding: 5px 15px;"></h2>
        <button class="btn-red" onclick="resumeExam()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø§Ù…ØªØ­Ø§Ù†</button>
    </div>

    <script>
        // --- 1. Ø­Ø¸Ø± Ø§Ù„ØªÙØ§Ø¹Ù„Ø§Øª (JS Blocking) ---
        
        // Ù…Ù†Ø¹ ÙƒÙ„ÙŠÙƒ ÙŠÙ…ÙŠÙ† (Context Menu)
        document.addEventListener('contextmenu', event => event.preventDefault());

        // Ù…Ù†Ø¹ Ø§Ù„Ù†Ø³Ø® ÙˆØ§Ù„Ù‚Øµ ÙˆØ§Ù„Ù„ØµÙ‚ (Copy, Cut, Paste)
        document.addEventListener('copy', e => { e.preventDefault(); showToast("Ù…Ù…Ù†ÙˆØ¹ Ø§Ù„Ù†Ø³Ø®!"); });
        document.addEventListener('cut', e => { e.preventDefault(); showToast("Ù…Ù…Ù†ÙˆØ¹ Ø§Ù„Ù‚Øµ!"); });
        document.addEventListener('paste', e => { e.preventDefault(); showToast("Ù…Ù…Ù†ÙˆØ¹ Ø§Ù„Ù„ØµÙ‚!"); });

        // Ù…Ù†Ø¹ Ø§Ø®ØªØµØ§Ø±Ø§Øª Ø§Ù„ÙƒÙŠØ¨ÙˆØ±Ø¯ (Ctrl+C, Ctrl+V, Ctrl+U, F12)
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey && (e.key === 'c' || e.key === 'v' || e.key === 'u' || e.key === 'a')) {
                e.preventDefault();
                showToast("Ø§Ø®ØªØµØ§Ø±Ø§Øª Ø§Ù„ÙƒÙŠØ¨ÙˆØ±Ø¯ Ù…Ù…Ù†ÙˆØ¹Ø©");
            }
            if (e.keyCode === 123) { // F12
                e.preventDefault();
            }
        });

        // --- Ø¨Ø§Ù‚ÙŠ Ø§Ù„ÙƒÙˆØ¯ (Ù†ÙØ³ V4) ---
        
        const startScreen = document.getElementById('start-screen');
        const examScreen = document.getElementById('exam-screen');
        const warningOverlay = document.getElementById('warning-overlay');
        const notifyBtn = document.getElementById('notifyBtn');
        const startBtn = document.getElementById('startBtn');
        const notifyStatus = document.getElementById('notifyStatus');
        const toast = document.getElementById('toast-notification');
        const watermarkContainer = document.querySelector('.watermark-container');
        let isExamActive = false;

        function generateWatermark() {
            for (let i = 0; i < 50; i++) {
                const item = document.createElement('div');
                item.classList.add('watermark-item');
                item.innerText = "Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ - ID:12345";
                watermarkContainer.appendChild(item);
            }
        }

        function showToast(msg) {
            toast.innerText = "âš ï¸ " + msg;
            toast.classList.add('show');
            setTimeout(() => { toast.classList.remove('show'); }, 3000);
        }

        function requestNotifyPermission() {
            if (!("Notification" in window)) { alert("Ø¬Ù‡Ø§Ø²Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª"); return; }
            Notification.requestPermission().then(permission => {
                if (permission === "granted") {
                    notifyStatus.innerText = "ØªÙ… Ø§Ù„ØªÙØ¹ÙŠÙ„ âœ…"; notifyStatus.style.color = "green";
                    notifyBtn.style.display = "none"; startBtn.style.display = "inline-block";
                } else {
                    notifyStatus.innerText = "ØªÙ… Ø§Ù„Ø±ÙØ¶ âŒ"; notifyStatus.style.color = "red";
                }
            });
        }

        function attemptStart() {
            if (window.innerWidth < window.screen.width * 0.9) { alert("Ø£ØºÙ„Ù‚ ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ø´Ø§Ø´Ø©!"); return; }
            if (!document.hasFocus()) { alert("Ø£ØºÙ„Ù‚ Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©!"); return; }
            document.documentElement.requestFullscreen().then(() => {
                startScreen.style.display = 'none'; examScreen.style.display = 'block';
                isExamActive = true; generateWatermark();
            }).catch(err => { alert("ÙŠØ¬Ø¨ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©"); });
        }

        function resumeExam() {
            if (window.innerWidth < window.screen.width * 0.9) { alert("Ø§Ù„Ø´Ø§Ø´Ø© Ù…Ù‚Ø³Ù…Ø©!"); return; }
            document.documentElement.requestFullscreen().then(() => {
                warningOverlay.style.display = 'none'; examScreen.style.display = 'block';
            });
        }

        function triggerViolation(reason) {
            if (!isExamActive) return;
            examScreen.style.display = 'none';
            warningOverlay.style.display = 'flex';
            document.getElementById('violation-reason').innerText = reason;
            showToast(reason);
            if (Notification.permission === "granted") {
                try { if (navigator.vibrate) navigator.vibrate([200]); new Notification("Ù…Ø®Ø§Ù„ÙØ©: " + reason); } catch(e){}
            }
        }

        // Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨ÙˆÙ†
        window.addEventListener('resize', () => { if (isExamActive && window.innerWidth < window.screen.width * 0.9) triggerViolation("ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ø´Ø§Ø´Ø©"); });
        document.addEventListener('visibilitychange', () => { if (isExamActive && document.hidden) triggerViolation("Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚"); });
        window.addEventListener('blur', () => { if (isExamActive) setTimeout(() => { if (!document.hasFocus()) triggerViolation("Ù„Ù…Ø³ Ø®Ø§Ø±Ø¬ÙŠ"); }, 200); });
        document.addEventListener('fullscreenchange', () => { if (isExamActive && !document.fullscreenElement) triggerViolation("Ø¥Ù„ØºØ§Ø¡ Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©"); });

    </script>
</body>
</html>
